{"createdAt":"2025-06-03T13:47:38.911Z","updatedAt":"2025-06-03T13:47:46.301Z","id":"aOQxw49Rb1EMEHtI","name":"[KARINE][CRM] - Pipeline Social Selling - Raiane - Parte 1 (manual via google forms)","active":false,"isArchived":false,"nodes":[{"parameters":{"jsCode":"const fullNameAnswer = $node[\"dados\"].json[\"body\"][\"Nome\"] || \"\";\nconst emailAnswer = $node[\"dados\"].json[\"body\"][\"E-mail\"] || \"\";\nconst telefoneClienteOriginal = $node[\"dados\"].json[\"body\"][\"Telefone\"] || '';\n\nfunction capitalizeName(fullName) {\n    if (!fullName) {\n        return { fname: '', lname: '', fullname: '' };\n    }\n\n    const lowerCaseWords = ['da', 'de', 'do', 'di', 'du'];\n    let words = fullName.trim().toLowerCase().split(' ').map((word, index) => {\n        if (lowerCaseWords.includes(word) && index !== 0) {\n            return word;\n        }\n        return word.charAt(0).toUpperCase() + word.slice(1);\n    });\n\n    let fname = words.shift() || '';\n    let lname = words.join(' ');\n\n    return { fname, lname, fullname: fname + (lname ? ' ' + lname : '') };\n}\n\nfunction formatEmail(email) {\n    return email.toLowerCase().trim();\n}\n\n// Garantir que telefoneClienteOriginal seja uma string antes de usar replace\nconst telefoneLimpo = String(telefoneClienteOriginal).replace(/\\D/g, \"\");\nconst DDI = '55';\nconst DDD = telefoneLimpo.slice(0, 2);\n\n// Determinar o número de telefone final\nconst telefoneFinal = `${DDI}${DDD}${telefoneLimpo.slice(2)}`;\n\nconst formattedNames = capitalizeName(fullNameAnswer);\nconst formattedEmail = formatEmail(emailAnswer);\nconst result = {\n    fname: formattedNames.fname, // Primeiro nome\n    lname: formattedNames.lname, // Sobrenome\n    fullname: formattedNames.fullname, // Nome completo\n    email: formattedEmail, // Email formatado\n    whatsapp: telefoneFinal, // WhatsApp formatado\n    qualificacao: \"qualificado\" // Variável adicional\n};\n\n// Aqui estamos ajustando a estrutura do retorno para se adequar ao que o n8n espera\nreturn [{ json: result }];\n"},"id":"f654aa6c-3d80-4c3c-aa71-fde529564e1f","name":"formata_dados","type":"n8n-nodes-base.code","typeVersion":2,"position":[280,-60]},{"parameters":{"queue":"[CRM] - Pipeline Social Selling - Raiane","options":{"arguments":{"argument":[{"key":"x-queue-type","value":"quorum"}]},"durable":true}},"id":"87aa4431-162b-40c7-b965-2ffefb20f7d0","name":"entra_na_fila","type":"n8n-nodes-base.rabbitmq","typeVersion":1.1,"position":[680,-60]},{"parameters":{"assignments":{"assignments":[{"id":"ed517c41-06e1-40b5-9a4d-c078f6f66dd1","name":"Nome","value":"={{ $json[\"body\"][\"Nome\"] }}","type":"string"},{"id":"615e3a48-42d7-4cf8-ab5e-0fec0960dbd8","name":"Email","value":"={{ $json[\"body\"][\"E-mail\"] }}","type":"string"},{"id":"eb3adfae-d1e6-4581-8e9e-16b10cbf602a","name":"Telefone","value":"={{ $json[\"body\"][\"Telefone\"] }}","type":"string"}]},"options":{}},"id":"c7c668bf-423e-4d7e-857e-ba740ce68e77","name":"dados","type":"n8n-nodes-base.set","typeVersion":3.3,"position":[80,-60]},{"parameters":{"assignments":{"assignments":[{"id":"b5d54eaf-eef2-4edd-b2f7-f896ee2ee2ac","name":"carreira","value":"","type":"string"},{"id":"571ac584-6a48-4585-ac44-3746e619e314","name":"tempo","value":"","type":"string"}]},"includeOtherFields":true,"options":{}},"id":"2574b261-5f5e-4ebd-8d21-7678c9722666","name":"inclui_dados","type":"n8n-nodes-base.set","typeVersion":3.3,"position":[480,-60]},{"parameters":{"httpMethod":"POST","path":"5a4c8750-8007-4363-882c-9db1b1e8ad3c","options":{}},"id":"9475c91d-ec1f-4828-9015-d57dd6be13a6","name":"google_forms","type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-120,-60],"webhookId":"5a4c8750-8007-4363-882c-9db1b1e8ad3c"}],"connections":{"formata_dados":{"main":[[{"node":"inclui_dados","type":"main","index":0}]]},"dados":{"main":[[{"node":"formata_dados","type":"main","index":0}]]},"inclui_dados":{"main":[[{"node":"entra_na_fila","type":"main","index":0}]]},"google_forms":{"main":[[{"node":"dados","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{"google_forms":[{"json":{"headers":{"host":"n8nwebhook.karinewaldrich.com.br","user-agent":"Mozilla/5.0 (compatible; Google-Apps-Script; beanserver; +https://script.google.com; id: UAEmdDd8EWNcxt_2_ZSt_TBVpX7pxMHoeaw)","content-length":"84","accept-encoding":"gzip, deflate, br","content-type":"application/json","x-forwarded-for":"34.116.22.1","x-forwarded-host":"n8nwebhook.karinewaldrich.com.br","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"cadf6fe75461","x-real-ip":"34.116.22.1"},"params":{},"query":{},"body":{"Nome":"Leo teste","E-mail":"leonardo.freymuth@gmail.com","Telefone":"51994696045"},"webhookUrl":"https://n8nwebhook.karinewaldrich.com.br/webhook/5a4c8750-8007-4363-882c-9db1b1e8ad3c","executionMode":"production"}}]},"versionId":"c7e4f144-e263-424d-b9d5-491d0985177f","triggerCount":0,"shared":[{"createdAt":"2025-06-03T13:47:38.911Z","updatedAt":"2025-06-03T13:47:38.911Z","role":"workflow:owner","workflowId":"aOQxw49Rb1EMEHtI","projectId":"E1RXJ9dhy40aA4CQ"}],"tags":[]}
{"createdAt":"2025-11-25T16:58:44.787Z","updatedAt":"2025-11-25T17:07:29.095Z","id":"IBt2hfXregeSby0N","name":"Backup GitHub WorkFlows","active":true,"isArchived":false,"nodes":[{"parameters":{"mode":"jsonToBinary","options":{"fileName":"={{ $json.name.replace(/\\s+/g, '-').toLowerCase() }}-{{ $json.id }}.json"}},"id":"40c507fa-8200-4365-9b99-63936da80a3a","name":"Move JSON to binary","type":"n8n-nodes-base.moveBinaryData","typeVersion":1,"position":[-352,128]},{"parameters":{"content":"## Acionar\nVocê pode alterá-lo para [gatilho \"Agendar\"](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.scheduletrigger/) para fazer backups regularmente.","height":380,"width":182},"id":"f0af823f-26e2-444f-ba45-307e1c17a67c","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1840,-80]},{"parameters":{"content":"## Definir e formatar data/hora\nEsses nós são responsáveis ​​por definir a data e hora atuais no formato `dd-MM-yyyy/H:mm`. Data e hora são usadas para compor mensagens de commit no GitHub, por exemplo: `backup-12-07-2023/14:18`.","height":379,"width":585},"id":"6fbefc81-8983-416d-8e64-582902cbf4bd","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1648,-80]},{"parameters":{"content":"## Faça uma lista de arquivos existentes\nRetorne uma lista de arquivos existentes (backups) no repositório GitHub. Os dados retornados por esses nós são usados ​​pelo nó \"IF\" (posteriormente no fluxo de trabalho) para verificar se os arquivos de backup devem ser criados ou atualizados.","height":379,"width":390},"id":"7c6e4821-b28a-43c6-bcec-a11e6b3bb384","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1040,-80]},{"parameters":{"content":"## Recupere os workflows\nObtenha todos os fluxos de trabalho da sua instância n8n. Lembre-se de que **suas credenciais precisam apontar para a instância da qual você deseja fazer backup.**","height":379,"width":424},"id":"d1ae51a9-a6bf-4c40-aa9a-40e01fff86b5","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-608,-80]},{"parameters":{"content":"## Carregar cópia de segurança\nDivida os arquivos JSON em lotes de 1, verifique se eles foram carregados no repositório antes. Se sim (true), carregue a nova versão do arquivo. Caso contrário (false) crie o arquivo no repositório.","height":731.633426614796,"width":703.8733020263451},"id":"fb0ccc2d-7ba6-4a1d-b734-cc93d3455372","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-176,-304]},{"parameters":{"authentication":"oAuth2","resource":"file","operation":"list","owner":{"__rl":true,"value":"https://github.com/bruno-infradev/infradev","mode":"url"},"repository":{"__rl":true,"value":"infradev","mode":"list","cachedResultName":"infradev","cachedResultUrl":"https://github.com/bruno-infradev/infradev"},"filePath":"="},"id":"6d235aa9-3f83-4126-8a50-94c182a28464","name":"Liste o Arquivos do Repositorio [GITHUB]","type":"n8n-nodes-base.github","typeVersion":1,"position":[-992,128],"alwaysOutputData":true,"webhookId":"d17b5bd9-7274-4e0b-9794-a99f772d9727","credentials":{"githubOAuth2Api":{"id":"Nkpknz3wxvGsWGRz","name":"GitHub Infradev"}}},{"parameters":{"operation":"aggregateItems","fieldsToAggregate":{"fieldToAggregate":[{"fieldToAggregate":"name"}]},"options":{}},"id":"415254b9-c06c-4013-868b-1a79e1639a16","name":"Combine os nomes do Arquivos [GITHUB]","type":"n8n-nodes-base.itemLists","typeVersion":2.1,"position":[-800,128]},{"parameters":{"keepOnlySet":true,"values":{"string":[{"name":"commitDate","value":"={{ $json.formattedDate }}"}]},"options":{}},"id":"df515f06-c797-4de2-8118-e3d2f9d95e53","name":"Setar a data do Commit","type":"n8n-nodes-base.set","typeVersion":2,"position":[-1200,128]},{"parameters":{"conditions":{"string":[{"value1":"={{ $node['Combine os nomes do Arquivos [GITHUB]'].json.name }}","operation":"contains","value2":"={{ $binary.data.fileName }}"}]}},"id":"ec7b201e-006a-458e-abae-56160e4b97e3","name":"Cheque se existem arquivos no Repositorio","type":"n8n-nodes-base.if","typeVersion":1,"position":[128,48]},{"parameters":{"options":{}},"id":"03a7bbb4-6c4c-4824-a9bd-9e5f8ceb4b66","name":"Sete a data","type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-1600,128]},{"parameters":{"operation":"formatDate","date":"={{ $json.currentDate }}","format":"custom","customFormat":"dd-MM-yyyy/H:mm","options":{}},"id":"7a5ac9b8-ee3f-4234-853d-dcc01ce52284","name":"Data formatada","type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-1408,128]},{"parameters":{"batchSize":1,"options":{}},"id":"a0ed2dab-e77d-4b01-9375-12b3f1bc5267","name":"Dividindo em Arquivos Únicos","type":"n8n-nodes-base.splitInBatches","typeVersion":2,"position":[-112,128]},{"parameters":{"filters":{},"requestOptions":{}},"id":"2b0bc671-0e17-479c-a81b-2c1912295515","name":"Recupere os workflows [N8N]","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[-560,128],"credentials":{"n8nApi":{"id":"wnj78qKpzpKxTxOB","name":"n8n account"}}},{"parameters":{"authentication":"oAuth2","resource":"file","operation":"edit","owner":{"__rl":true,"value":"https://github.com/bruno-infradev/infradev","mode":"url"},"repository":{"__rl":true,"value":"infradev","mode":"list","cachedResultName":"infradev","cachedResultUrl":"https://github.com/bruno-infradev/infradev"},"filePath":"={{ $binary.data.fileName }}","binaryData":true,"commitMessage":"=backup-{{ $node['Setar a data do Commit'].json.commitDate }}"},"id":"8cd0d422-fa9f-4f21-863f-0d53e7f6e4e7","name":"Atualiza Arquivos [GITHUB]","type":"n8n-nodes-base.github","typeVersion":1,"position":[352,-160],"webhookId":"e865ca08-996d-489b-befa-1b15d12c4764","credentials":{"githubOAuth2Api":{"id":"Nkpknz3wxvGsWGRz","name":"GitHub Infradev"}}},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"https://github.com/bruno-infradev/infradev","mode":"url"},"repository":{"__rl":true,"value":"infradev","mode":"list","cachedResultName":"infradev","cachedResultUrl":"https://github.com/bruno-infradev/infradev"},"filePath":"={{ $binary.data.fileName }}","binaryData":true,"commitMessage":"=backup-{{ $node['Setar a data do Commit'].json.commitDate }}"},"id":"31d7d73d-03c1-43b7-a026-1cb4f42670bb","name":"Atualiza arquivos [GITHUB]","type":"n8n-nodes-base.github","typeVersion":1,"position":[352,240],"webhookId":"4a71ea92-4a2b-4d05-82b2-6aa53677d1b9","credentials":{"githubOAuth2Api":{"id":"Nkpknz3wxvGsWGRz","name":"GitHub Infradev"}}},{"parameters":{"rule":{"interval":[{"triggerAtHour":7}]}},"id":"91d0a7e8-51e3-47b0-a3dd-c00da71c518f","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-1808,128]}],"connections":{"Move JSON to binary":{"main":[[{"node":"Dividindo em Arquivos Únicos","type":"main","index":0}]]},"Liste o Arquivos do Repositorio [GITHUB]":{"main":[[{"node":"Combine os nomes do Arquivos [GITHUB]","type":"main","index":0}]]},"Combine os nomes do Arquivos [GITHUB]":{"main":[[{"node":"Recupere os workflows [N8N]","type":"main","index":0}]]},"Setar a data do Commit":{"main":[[{"node":"Liste o Arquivos do Repositorio [GITHUB]","type":"main","index":0}]]},"Cheque se existem arquivos no Repositorio":{"main":[[{"node":"Atualiza Arquivos [GITHUB]","type":"main","index":0}],[{"node":"Atualiza arquivos [GITHUB]","type":"main","index":0}]]},"Sete a data":{"main":[[{"node":"Data formatada","type":"main","index":0}]]},"Data formatada":{"main":[[{"node":"Setar a data do Commit","type":"main","index":0}]]},"Dividindo em Arquivos Únicos":{"main":[[{"node":"Cheque se existem arquivos no Repositorio","type":"main","index":0}]]},"Recupere os workflows [N8N]":{"main":[[{"node":"Move JSON to binary","type":"main","index":0}]]},"Atualiza Arquivos [GITHUB]":{"main":[[{"node":"Dividindo em Arquivos Únicos","type":"main","index":0}]]},"Atualiza arquivos [GITHUB]":{"main":[[{"node":"Dividindo em Arquivos Únicos","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Sete a data","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"c7a4b137-4318-46bc-9846-f7f16f6d7b7f","triggerCount":1,"shared":[{"createdAt":"2025-11-25T16:58:44.787Z","updatedAt":"2025-11-25T16:58:44.787Z","role":"workflow:owner","workflowId":"IBt2hfXregeSby0N","projectId":"E1RXJ9dhy40aA4CQ"}],"tags":[{"createdAt":"2025-11-25T16:58:48.622Z","updatedAt":"2025-11-25T16:58:48.622Z","id":"KrrqY5F1XyTRG95W","name":"NÃO MEXER"},{"createdAt":"2025-11-25T16:58:57.474Z","updatedAt":"2025-11-25T16:58:57.474Z","id":"WyvxDncL33ec3iYV","name":"github"}]}
{"createdAt":"2025-06-03T13:39:53.699Z","updatedAt":"2025-06-03T13:39:58.837Z","id":"aC8UwSOiOOc34JCy","name":"[KARINE][CRM] - Pipeline Fundo de Funil - Juliana - Parte 1 (manual via google forms)","active":false,"isArchived":false,"nodes":[{"parameters":{"jsCode":"const fullNameAnswer = $node[\"dados\"].json[\"body\"][\"Nome\"] || \"\";\nconst emailAnswer = $node[\"dados\"].json[\"body\"][\"E-mail\"] || \"\";\nconst telefoneClienteOriginal = $node[\"dados\"].json[\"body\"][\"Telefone\"] || '';\n\nfunction capitalizeName(fullName) {\n    if (!fullName) {\n        return { fname: '', lname: '', fullname: '' };\n    }\n\n    const lowerCaseWords = ['da', 'de', 'do', 'di', 'du'];\n    let words = fullName.trim().toLowerCase().split(' ').map((word, index) => {\n        if (lowerCaseWords.includes(word) && index !== 0) {\n            return word;\n        }\n        return word.charAt(0).toUpperCase() + word.slice(1);\n    });\n\n    let fname = words.shift() || '';\n    let lname = words.join(' ');\n\n    return { fname, lname, fullname: fname + (lname ? ' ' + lname : '') };\n}\n\nfunction formatEmail(email) {\n    return email.toLowerCase().trim();\n}\n\n// Garantir que telefoneClienteOriginal seja uma string antes de usar replace\nconst telefoneLimpo = String(telefoneClienteOriginal).replace(/\\D/g, \"\");\nconst DDI = '55';\nconst DDD = telefoneLimpo.slice(0, 2);\n\n// Determinar o número de telefone final\nconst telefoneFinal = `${DDI}${DDD}${telefoneLimpo.slice(2)}`;\n\nconst formattedNames = capitalizeName(fullNameAnswer);\nconst formattedEmail = formatEmail(emailAnswer);\nconst result = {\n    fname: formattedNames.fname, // Primeiro nome\n    lname: formattedNames.lname, // Sobrenome\n    fullname: formattedNames.fullname, // Nome completo\n    email: formattedEmail, // Email formatado\n    whatsapp: telefoneFinal, // WhatsApp formatado\n    qualificacao: \"qualificado\" // Variável adicional\n};\n\n// Aqui estamos ajustando a estrutura do retorno para se adequar ao que o n8n espera\nreturn [{ json: result }];\n"},"id":"cad4d661-d9f9-4511-9c40-a81e6d7f8c20","name":"formata_dados","type":"n8n-nodes-base.code","typeVersion":2,"position":[420,0]},{"parameters":{"queue":"[CRM] - Pipeline Fundo de Funil - Jéssica","options":{"arguments":{"argument":[{"key":"x-queue-type","value":"quorum"}]},"durable":true}},"id":"dc8dac29-eb3c-4e28-9f4e-be5c58624f89","name":"entra_na_fila","type":"n8n-nodes-base.rabbitmq","typeVersion":1.1,"position":[880,0]},{"parameters":{"assignments":{"assignments":[]},"includeOtherFields":true,"options":{}},"id":"23256271-0335-4411-a3af-967ba09f5f18","name":"dados","type":"n8n-nodes-base.set","typeVersion":3.3,"position":[220,0]},{"parameters":{"assignments":{"assignments":[{"id":"b5d54eaf-eef2-4edd-b2f7-f896ee2ee2ac","name":"carreira","value":"","type":"string"},{"id":"571ac584-6a48-4585-ac44-3746e619e314","name":"tempo","value":"","type":"string"}]},"includeOtherFields":true,"options":{}},"id":"168298fc-d558-4408-8e95-9f9cbc4b4ed3","name":"inclui_dados","type":"n8n-nodes-base.set","typeVersion":3.3,"position":[640,0]},{"parameters":{"httpMethod":"POST","path":"2f7d192a-db92-4273-9436-f447bc33543f","options":{}},"id":"01c75c99-128d-4ee9-9db8-97b35fc35e70","name":"google_forms","type":"n8n-nodes-base.webhook","typeVersion":2,"position":[0,0],"webhookId":"2f7d192a-db92-4273-9436-f447bc33543f"}],"connections":{"formata_dados":{"main":[[{"node":"inclui_dados","type":"main","index":0}]]},"dados":{"main":[[{"node":"formata_dados","type":"main","index":0}]]},"inclui_dados":{"main":[[{"node":"entra_na_fila","type":"main","index":0}]]},"google_forms":{"main":[[{"node":"dados","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{"google_forms":[{"json":{"headers":{"host":"n8nwebhook.karinewaldrich.com.br","user-agent":"Mozilla/5.0 (compatible; Google-Apps-Script; beanserver; +https://script.google.com; id: UAEmdDd9Thz3LYtCxRm8eIMutBV2itXrnwkk)","content-length":"60","accept-encoding":"gzip, deflate, br","content-type":"application/json","x-forwarded-for":"35.187.134.131","x-forwarded-host":"n8nwebhook.karinewaldrich.com.br","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"cadf6fe75461","x-real-ip":"35.187.134.131"},"params":{},"query":{},"body":{"Nome":"Tais Araujo","E-mail":"","Telefone":"51 8253-2807"},"webhookUrl":"https://n8nwebhook.karinewaldrich.com.br/webhook/2f7d192a-db92-4273-9436-f447bc33543f","executionMode":"production"}}]},"versionId":"2fa88efd-bd28-472c-8c6f-0f6309614e4e","triggerCount":0,"shared":[{"createdAt":"2025-06-03T13:39:53.699Z","updatedAt":"2025-06-03T13:39:53.699Z","role":"workflow:owner","workflowId":"aC8UwSOiOOc34JCy","projectId":"E1RXJ9dhy40aA4CQ"}],"tags":[]}